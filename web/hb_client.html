<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
</head>
<body>

<h2>Open your JavaScript console!</h2>

<div>
    <form name="my_form">
        App ID: <input type="text" name="app_id" value="browser_app"/><br/>
        Interval: <input type="text" name="interval" value="2"/> seconds
    </form>
</div>
<div>
    <button type="button" onclick="heartbeart( document.my_form.app_id.value, 'hb_init', document.my_form.interval.value );">Init HB</button>
    <button type="button" onclick="heartbeart( document.my_form.app_id.value, 'hb_ping', document.my_form.interval.value );">Ping HB</button>
    <button type="button" onclick="heartbeart( document.my_form.app_id.value, 'hb_done', document.my_form.interval.value );">Done HB</button>
</div>
<div>
    <textarea id="console" style="width:100%; height: 400px;"></textarea>
</div>

<script>
var HB_URL = "http://localhost:8888";
var text_console = document.getElementById( "console" );
text_console.value = "";

function heartbeart( APP_ID, HB_COMMAND, HB_INTERVAL )
{
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (xhttp.readyState == 4 && xhttp.status == 200) {
        text_console.value += "RESPONSE: " + xhttp.responseText + "\n";
      }
    };
    var url = HB_URL + "/" + HB_COMMAND + "?" + HB_INTERVAL + "&appid=" + APP_ID + "&cache_buster=" + new Date().getTime()
    text_console.value += " REQUEST: " + url + "\n";
    xhttp.open("GET", url, true);
    xhttp.send();
}
</script>

</body>
</html>
